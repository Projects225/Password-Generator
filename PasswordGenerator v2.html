<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Password Generator 2</title>
<link rel="icon" type="image/png" href="PasswordGenerator.png">
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #121212;
    color: #e0e0e0;
    margin: 50px;
  }
  h1, h2 {
    text-align: center;
    font-weight: bold;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
  }
  input, textarea, button {
    font-size: 14px;
    padding: 8px;
    margin-top: 5px;
    border-radius: 5px;
    border: none;
  }
  textarea {
    width: 100%;
    resize: vertical;
    height: 60px;
    background-color: #1e1e1e;
    color: #e0e0e0;
  }
  input[type="number"], input[type="text"] {
    width: 100%;
    background-color: #1e1e1e;
    color: #e0e0e0;
  }
  button {
    background-color: #6200ea;
    color: #fff;
    cursor: pointer;
    transition: 0.2s;
  }
  button:active {
    transform: scale(0.98);
  }
  #output {
    white-space: pre;
    background-color: #1e1e1e;
    padding: 10px;
    border-radius: 5px;
    border: 1px solid #333;
    margin-top: 10px;
    position: relative;
    max-height: 500px;
    overflow-y: auto;
  }
  .line-number {
    user-select: none;
    color: #888;
    display: inline-block;
    width: 40px;
    text-align: right;
    margin-right: 10px;
  }
  .page-icon {
    position: fixed;   
    top: 10px;
    left: 10px;
    width: 40px;       
    height: 40px;
  }
  .necessary {
    color: #ff0000;
    width: 100%;
  }
  .seed-row {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  #clearSeedBtn {
    background-color: #c62828;
    flex-shrink: 0;
  }
  #clearSeedBtn:hover {
    background-color: #e53935;
  }
  
</style>
<a href="index.html"><img src="PasswordGenerator.png" alt="Logo" class="page-icon"></a>
</head>
<body>

<h1>Password Generator <span style="color: #00ce0a;">2</span></h1>

<label for="inputText"><span class="necessary">*</span> Key :</label>
<textarea id="inputText" placeholder="Enter your key here"></textarea>

<label for="seedInput">Seed (Optional)</label>
<div class="seed-row">
  <input type="text" id="seedInput" placeholder="Default seed used if empty" style="width: 25%;">
  <button id="clearSeedBtn">üóëÔ∏è Clear Seed</button>
</div>

<label for="length"><span class="necessary">*</span> Output Length :</label>
<input type="number" id="length" placeholder="Output Length: 3" min="1" style="width: 25%;">

<label for="lineLength"><span class="necessary">*</span> Characters per Line :</label>
<input type="number" id="lineLength" placeholder="Characters per Line: 80" min="1" style="width: 25%;">

<label for="specificLine">Specific Line (Optional):</label>
<input type="number" id="specificLine" placeholder="Specific Line: to not necessary" min="1" style="width: 25%;">

<button id="generateBtn">üîß Generate</button>
<button id="copyBtn">üíæ Copy</button>

<h2>Output:</h2>
<div id="output"></div>

<script>
const DEFAULT_SEED = 'DefaultSeed123';

function generateRandomText(seed, length) {
  function mulberry32(a) {
    return function() {
      var t = a += 0x6D2B79F5;
      t = Math.imul(t ^ (t >>> 15), t | 1);
      t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
      return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
    }
  }
  let numSeed = 0;
  for (let i = 0; i < seed.length; i++) {
    numSeed += seed.charCodeAt(i) * (i + 1);
  }
  const rand = mulberry32(numSeed);

  // Removed problematic symbols for Excel
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%^&*()_[]{}|;:,.<>?~';

  let output = '';
  for (let i = 0; i < length; i++) {
    output += chars.charAt(Math.floor(rand() * chars.length));
  }
  return output;
}

function formatOutput(text, lineLength, specificLine) {
  const lines = [];
  for (let i = 0; i < text.length; i += lineLength) {
    lines.push(text.slice(i, i + lineLength));
  }

  if (specificLine) {
    const index = specificLine - 1;
    if (index >= 0 && index < lines.length) {
      return [{number: specificLine, text: lines[index]}];
    } else {
      return [];
    }
  }

  return lines.map((line, idx) => ({number: idx + 1, text: line}));
}

function displayOutput(formattedLines) {
  const outputDiv = document.getElementById('output');
  outputDiv.innerHTML = '';
  formattedLines.forEach(line => {
    const lineDiv = document.createElement('div');
    const lineNumber = document.createElement('span');
    lineNumber.textContent = line.number;
    lineNumber.className = 'line-number';
    const lineText = document.createElement('span');
    lineText.textContent = line.text;
    lineDiv.appendChild(lineNumber);
    lineDiv.appendChild(lineText);
    outputDiv.appendChild(lineDiv);
  });
}

// Load saved seed from localStorage
window.addEventListener('load', () => {
  const savedSeed = localStorage.getItem('savedSeed');
  if (savedSeed) {
    document.getElementById('seedInput').value = savedSeed;
  } else {
    document.getElementById('seedInput').placeholder = `Default seed: ${DEFAULT_SEED}`;
  }
  document.getElementById('inputText').value = '';
  document.getElementById('length').value = '';
  document.getElementById('lineLength').value = '';
  document.getElementById('specificLine').value = '';
});

// Generate
document.getElementById('generateBtn').addEventListener('click', () => {
  const inputText = document.getElementById('inputText').value || 'default';
  const length = (parseInt(document.getElementById('length').value) || 3) * 1000;
  const lineLength = parseInt(document.getElementById('lineLength').value) || 80;
  const specificLine = parseInt(document.getElementById('specificLine').value) || null;
  
  let seedInput = document.getElementById('seedInput');
  let seed = seedInput.value || DEFAULT_SEED;

  // Save or clear seed depending on input
  if (seedInput.value) {
    localStorage.setItem('savedSeed', seed);
  } else {
    localStorage.removeItem('savedSeed');
  }

  const rawOutput = generateRandomText(seed + inputText, length);
  const formatted = formatOutput(rawOutput, lineLength, specificLine);
  displayOutput(formatted);
});

// Copy output
document.getElementById('copyBtn').addEventListener('click', () => {
  const outputDiv = document.getElementById('output');
  const lines = Array.from(outputDiv.querySelectorAll('div span:last-child')).map(span => span.textContent);
  if (lines.length === 0) return;

  const textToCopy = lines.join('\n');
  navigator.clipboard.writeText(textToCopy).then(() => {
    const btn = document.getElementById('copyBtn');
    const originalText = btn.textContent;
    btn.textContent = 'Copied';
    btn.style.backgroundColor = '#00C853';
    setTimeout(() => {
      btn.textContent = originalText;
      btn.style.backgroundColor = '#6200ea';
    }, 2000);
  });
});

// Clear seed manually
document.getElementById('clearSeedBtn').addEventListener('click', () => {
  localStorage.removeItem('savedSeed');
  document.getElementById('seedInput').value = '';
});
</script>

</body>
</html>
